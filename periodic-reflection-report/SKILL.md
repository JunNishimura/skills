---
name: periodic-reflection-report
description: Generate a reflection report for a user-specified time period using daily reflection records in Notion; summarize experiences, themes, growth, and propose next actions, then optionally save to Notion via MCP.
---

# 定期振り返りレポート作成スキル

## 概要

このスキルは、ユーザーが Notion 上で行った日々の振り返り記録をもとに、指定された期間の振り返りレポートを生成するものである。

レポートは以下の要素を含む。

- 期間中の主な経験の要約
- 繰り返し現れたテーマやパターンの特定
- 日々の感情の移り変わりの分析
- ユーザーの成長や学びのハイライト
- 次の行動への提案

また、生成されたレポートを MCP を通じて Notion に保存する。

## 基本方針

- 振り返りレポートはユーザーの自己理解と成長を促進するものである
- ユーザーの振り返り内容を尊重し、客観的かつ建設的にまとめる
- 提案される次の行動は具体的で実行可能なものである
- レポートは明確で読みやすい形式で提供する

## 注意点

- ユーザーの振り返り内容を評価・採点しない
- 正解・不正解を決めない

## フェーズ構成

以下のフェーズを一つずつ順に実行する。

### フェーズ1: 期間の確定

このフェーズでは、ユーザーに振り返りレポートを生成する対象期間を尋ねる。
ユーザーが具体的な日付範囲を指定できるよう促す。

### フェーズ2: 振り返りデータの収集

このフェーズでは、指定された期間内のユーザーの Notion 上の日々の振り返り記録を収集する。
必要に応じて、Notion MCP を使用してデータを取得する。

#### 条件

- ユーザーが Notion MCP を設定していること
- 指定された期間内に振り返り記録が存在すること
- Database のURLは環境変数 `DAILY_REFLECTION_DB_URL` に保存されていること
- データを取得する際の検索条件は、DBの「日付」プロパティを使用し、指定された期間内のレコードをフィルタリングすること

### フェーズ3: 経験の要約

このフェーズでは、収集した振り返りデータから、期間中の主な経験を要約する。
各日の振り返り内容を分析し、共通するテーマや重要な出来事を抽出する。

### フェーズ4: テーマとパターンの特定

このフェーズでは、振り返りデータを分析し、繰り返し現れたテーマやパターンを特定する。
ユーザーの行動や感情の傾向を把握し、重要なポイントを明らかにする。

### フェーズ5: 感情分析（時系列）

このフェーズでは、Notion から取得した日々の振り返りデータをもとに感情分析を実施し、日々の感情の移り変わりを分析する。

#### 手順

1. 期間内の日次データから次の形式の入力 JSON を作成する。

```json
{
  "records": [
    {
      "date": "2026-01-05",
      "experience": "...",
      "reflection": "...",
      "abstraction": "...",
      "next_action": "..."
    }
  ]
}
```

2. 次のコマンドで感情分析を実施する。

```bash
python periodic-reflection-report/scripts/analyze_emotion_timeline.py --in <emotion_input.json> --outdir periodic-reflection-report/scripts/out
```

3. `periodic-reflection-report/scripts/out/emotion_timeline.json` から以下を読み取り、レポートへ反映する。
   - 平均感情スコア（`average_sentiment`）
   - ポジティブ/ニュートラル/ネガティブの日数（`label_counts`）
   - 感情トレンド（`trend`: `improving` / `stable` / `declining`）
   - よく現れた感情（`most_common_emotions`）
   - 日次の推移（`timeline`）

### フェーズ6: 成長と学びのハイライト

このフェーズでは、ユーザーの振り返り内容から成長や学びのハイライトを抽出する。
ユーザーがどのように変化し、何を学んだかを明確に示す。

### フェーズ7: 次の行動への提案

このフェーズでは、ユーザーの成長や学びに基づいて、次に取るべき具体的な行動を提案する。
提案は具体的で実行可能なものであり、ユーザーが次のステップを踏み出すのに役立つものである

### フェーズ8: レポートの生成

このフェーズでは、前のフェーズで得られた情報をもとに、振り返りレポートを生成する。
レポートは以下のセクションで構成される。

- 期間中の主な経験の要約
- 繰り返し現れたテーマやパターンの特定
- 感情分析（時系列）
- ユーザーの成長や学びのハイライト
- 次の行動への提案
- 総括

総括以外の各セクションは、箇条書き形式で提供する。

### フェーズ9: Notion への保存

このフェーズでは、生成された振り返りレポートを Notion の指定されたページ配下に新しいページとして保存する。

#### 条件

- ユーザーは Notion MCP を設定している
- 親となるページの URL は環境変数 `PERIODIC_REFLECTION_PAGE_URL` に格納されている
- レポートは Markdown 形式で保存される
- タイトルは「振り返りレポート: YYYY年MM月DD日 - YYYY年MM月DD日」の形式とする
